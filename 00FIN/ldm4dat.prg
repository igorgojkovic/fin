PROCEDURE LDM4DAT
PUSH KEY CLEAR
DO DODIZV3 WITH 1,CTOD('28.02.2003')
DO DODIZV3 WITH 2,CTOD('31.03.2003')
DO DODIZV3 WITH 3,CTOD('30.04.2003')
DO DODIZV3 WITH 4,CTOD('31.05.2003')
DO DODIZV3 WITH 5,CTOD('30.06.2003')
DO DODIZV3 WITH 6,CTOD('31.07.2003')
DO DODIZV3 WITH 7,CTOD('31.08.2003')
DO DODIZV3 WITH 8,CTOD('30.09.2003')
DO DODIZV3 WITH 9,CTOD('31.10.2003')
DO DODIZV3 WITH 10,CTOD('30.11.2003')
DO DODIZV3 WITH 11,CTOD('31.12.2003')
DO DODIZV3 WITH 12,CTOD('31.12.2003')

DO DODIZV3 WITH 13,CTOD('28.02.2003')
DO DODIZV3 WITH 14,CTOD('31.03.2003')
DO DODIZV3 WITH 15,CTOD('30.04.2003')
DO DODIZV3 WITH 16,CTOD('31.05.2003')
DO DODIZV3 WITH 17,CTOD('30.06.2003')
DO DODIZV3 WITH 18,CTOD('31.07.2003')
DO DODIZV3 WITH 19,CTOD('31.08.2003')
DO DODIZV3 WITH 20,CTOD('30.09.2003')
DO DODIZV3 WITH 21,CTOD('31.10.2003')
DO DODIZV3 WITH 22,CTOD('30.11.2003')
DO DODIZV3 WITH 23,CTOD('31.12.2003')
DO DODIZV3 WITH 24,CTOD('31.12.2003')
POP KEY
ENDPROC

PROCEDURE DODIZV3
   PARAMETERS AA,BB
   PUSH KEY CLEAR

   APPEND BLANK
   REPLACE MES WITH AA
   REPLACE DAT WITH BB
   REPLACE CAS WITH DANRAC(AA)
   POP KEY
endproc



FUNCTION DANRAC
PARAMETERS aac
PUSH KEY CLEAR

MMES=AAC
DO CASE mmes
case MMES=1.OR.MMES=13
   MDATPOC=CTOD('01.01.2003')
   MDATKRAJ=CTOD('31.01.2003')
case MMES=2.OR.MMES=14
   MDATPOC=CTOD('01.02.2003')
   MDATKRAJ=CTOD('28.02.2003')
case MMES=3.OR.MMES=15
   MDATPOC=CTOD('01.03.2003')
   MDATKRAJ=CTOD('31.03.2003')
case MMES=4.OR.MMES=16
   MDATPOC=CTOD('01.04.2003')
   MDATKRAJ=CTOD('30.04.2003')
case MMES=5.OR.MMES=17
   MDATPOC=CTOD('01.05.2003')
   MDATKRAJ=CTOD('31.05.2003')
case MMES=6.OR.MMES=18
   MDATPOC=CTOD('01.06.2003')
   MDATKRAJ=CTOD('30.06.2003')
case MMES=7.OR.MMES=19
   MDATPOC=CTOD('01.07.2003')
   MDATKRAJ=CTOD('31.07.2003')
case MMES=8.OR.MMES=20
   MDATPOC=CTOD('01.08.2003')
   MDATKRAJ=CTOD('31.08.2003')
case MMES=9.OR.MMES=21
   MDATPOC=CTOD('01.09.2003')
   MDATKRAJ=CTOD('30.09.2003')
case MMES=10.OR.MMES=22
   MDATPOC=CTOD('01.10.2003')
   MDATKRAJ=CTOD('31.10.2003')
case MMES=10.OR.MMES=23
   MDATPOC=CTOD('01.11.2003')
   MDATKRAJ=CTOD('30.11.2003')
OTHERWISE
   MDATPOC=CTOD('01.12.2003')
   MDATKRAJ=CTOD('31.12.2003')
ENDCASE

   MDANA=MDATKRAJ-MDATPOC
   MDANA2=0
   FOR I=0 TO MDANA
      MDAN=MDATPOC+I
      MDOW=DOW(MDAN)
      IF DOW(MDAN)>=2.AND.DOW(MDAN)<=6
         MDANA2=MDANA2+8
      ENDIF
   NEXT
   POP KEY
   RETURN(MDANA2)


